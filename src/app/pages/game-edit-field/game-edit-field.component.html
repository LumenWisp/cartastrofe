<div class="sidebar-right" [ngClass]="{ expanded: sidebarExpanded }">
  <div class="top-bar">
    <p-button
      [routerLink]="['/my-games/game-description', game.id]"
      label="Voltar"
    />

    <!-- Botão toggle -->
    <p-button
      [icon]="sidebarExpanded ? 'pi pi-angle-right' : 'pi pi-angle-left'"
      class="sidebar-toggle"
      (click)="sidebarExpanded = !sidebarExpanded"
    />
  </div>

  <div class="toolbox">
    <!-- Botão para adicionar pilha -->
    <div class="tool-card" (click)="addPile()">
      <div class="pile-preview"></div>
      <span>Pilha</span>
    </div>

    <!-- Botão para adicionar label 
      <div class="tool-card" (click)="addLabel()">
        <div class="label-preview">Label Attribute</div>
      </div>
    -->
  </div>
  
  @if (sidebarExpanded) {

  <!--   
  <div class="options">
    <span>Atributos do jogo</span>

    <div class="option-input-btn">
      <input
        type="text"
        #nameAttribute
        pInputText
        placeholder="Nome do atributo"
      />
      <p-button
        class="add-btn-options"
        label="Salvar atributo"
        icon="pi pi-save"
        (click)="saveAttribute(nameAttribute.value)"
      />
    </div>
    <p-listbox [options]="optionsAttribute" />
  </div>
  -->

  <div class="options">
    <span>Fases do jogo</span>

    <div class="option-input-btn">
      <input type="text" #namePhase pInputText placeholder="Nome da fase" />
      <p-button
        class="add-btn-options"
        label="Salvar fase"
        icon="pi pi-save"
        (click)="savePhase(namePhase.value)"
      />
    </div>

    <p-listbox
      [options]="optionsPhase"
      [(ngModel)]="selectedPhase"
    >
      <ng-template let-option pTemplate="item">
        <div class="flex justify-between items-center w-full">
          <span>{{ option }}</span>
          <button
            pButton
            icon="pi pi-trash"
            class="p-button-rounded p-button-text p-button-danger"
            (click)="deleteOption(option); $event.stopPropagation()"
          ></button>
        </div>
      </ng-template>
    </p-listbox>


  </div>
  }

  <p-button class="btn-save-field" label="Salvar Campo" (click)="saveField()" />
</div>

<div class="hand-area-container" #handAreaContainer>
    </div>
    <div class="hand-area" #handArea></div>

<!-- Área de jogo -->
<div class="game-field" #gameField>
  @for (item of items; track item; let i = $index) { @if (item.type ===
  'passPhase') {

  <button
    cdkDrag
    cdkDragBoundary=".game-field"
    (cdkDragEnded)="onDragEnd($event, 0)"
    [cdkDragFreeDragPosition]="item.position"
    class="next-phase-btn"
  >
    Próxima Fase
  </button>

    }

    @else if (item.type === 'hand') {
      <!--<div 
        [ngClass]="item.type"
        [id]="item.nameIdentifier">
        {{ item.nameIdentifier }}
    </div> -->
    }

    @else {

  <div
    cdkDrag
    cdkDragBoundary=".game-field"
    (cdkDragEnded)="onDragEnd($event, i)"
    [cdkDragFreeDragPosition]="item.position"
    [ngClass]="item.type"
    (contextmenu)="onItemClick($event, i, popover)"
    style="display: flex; justify-content: center; align-items: center; text-align: center;"
  >
    {{ item.nameIdentifier }}
  </div>

  } }
  <!-- Popover para menu -->
  <p-popover #popover>
    <div class="menu-options">
      <button
        pButton
        type="button"
        icon="pi pi-trash"
        label="Deletar"
        (click)="deleteItem(selectedItemIndex!, popover)"
      ></button>
    </div>
  </p-popover>
</div>

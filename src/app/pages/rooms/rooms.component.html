<div class="sidebar-right">
  <p-button routerLink="/my-games" label="Sair" />

  <p-panel header="{{'rooms.header' | translate}}">
    @for (player of players; track $index) {
    <div class="menu-item">
      {{ player.name }}
    </div>
    }
  </p-panel>
</div>

<div class="play-area" #playArea>
  <div class="grid">
    @for (card of freeModeService.cards(); track $index) { @if
    (freeModeService.isTopCard(card.id!) || !card.pileId) {
    <div
      class="card"
      [class.flipped]="card.flipped"
      (dblclick)="freeModeService.flipCard(card.id!);this.updateRoom();"
      (contextmenu)="showOptions($event, card, popover)"
      (cdkDragEnded)="onDrop($event)"
      (cdkDragStarted)="onDragStart($event)"
      cdkDrag
      [cdkDragBoundary]="playArea"
      [cdkDragFreeDragPosition]="card.freeDragPos"
      [attr.card-id]="card.id"
      [style.z-index]="card.zIndex"
    >
      @if (freeModeService.isPartOfPile(card.id!)) {
      <div
        class="square-number-cards"
      >
        {{ freeModeService.getNumberOfCardsFromPileId(card.pileId!) }}
      </div>
      }
      <div class="card-inner">
        <div class="face front" [attr.card-id]="card.id">{{ card.label }}</div>
        <div class="face back" [attr.card-id]="card.id"></div>
      </div>
    </div>
    } }
  </div>
</div>

<p-popover #popover [dismissable]="true">
  @if(selectedCard && freeModeService.isPartOfPile(selectedCard.id!)) {
  <ng-container>
    <p-button
      label="Embaralhar"
      icon="pi pi-refresh"
      (click)="onShuffleClick(popover)"
    ></p-button>
  </ng-container>
  }
</p-popover>
